<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlsTapingTools.com Product Scraper</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            text-align: center;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .control-panel {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .progress-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            display: none;
        }

        .progress-section.active {
            display: block;
        }

        .progress-bar-container {
            background: #f0f0f0;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-bar {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .status-log {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .status-item {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }

        .status-item:last-child {
            border-bottom: none;
        }

        .status-item.info {
            color: #0066cc;
        }

        .status-item.success {
            color: #28a745;
        }

        .status-item.warning {
            color: #ffc107;
        }

        .status-item.error {
            color: #dc3545;
        }

        .results-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: none;
        }

        .results-section.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .products-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .products-table th,
        .products-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .products-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        .products-table tr:hover {
            background: #f8f9fa;
        }

        .product-image {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 5px;
        }

        .download-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .download-btn {
            flex: 1;
            background: #28a745;
            color: white;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .download-btn:hover {
            background: #218838;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        @media (max-width: 768px) {
            .grid-container {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ðŸ”§ AlsTapingTools.com Product Scraper</h1>
            <p class="subtitle">Comprehensive product data extraction with images, prices, SKUs & descriptions</p>
        </div>

        <!-- Control Panel -->
        <div class="control-panel">
            <h2 style="margin-bottom: 20px;">Configuration</h2>
            
            <div class="grid-container">
                <div class="input-group">
                    <label for="url-input">Website URL:</label>
                    <input type="text" id="url-input" value="http://alstapingtools.com" placeholder="Enter website URL">
                </div>

                <div class="input-group">
                    <label for="delay-input">Request Delay (seconds):</label>
                    <input type="number" id="delay-input" value="1.5" min="0.5" max="10" step="0.5">
                </div>
            </div>

            <div class="grid-container">
                <div class="checkbox-group">
                    <input type="checkbox" id="download-images" checked>
                    <label for="download-images" style="margin: 0;">Download Product Images</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="extract-descriptions" checked>
                    <label for="extract-descriptions" style="margin: 0;">Extract Descriptions</label>
                </div>
            </div>

            <button class="btn" id="start-scrape-btn" onclick="startScraping()">
                ðŸš€ Start Scraping
            </button>
        </div>

        <!-- Progress Section -->
        <div class="progress-section" id="progress-section">
            <h2 style="margin-bottom: 20px;">Scraping Progress</h2>
            
            <div class="progress-bar-container">
                <div class="progress-bar" id="progress-bar">0%</div>
            </div>

            <div style="margin-bottom: 15px;">
                <strong>Status:</strong> <span id="current-status">Initializing...</span>
            </div>

            <div class="status-log" id="status-log">
                <div class="status-item info">Ready to begin scraping...</div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="results-section">
            <h2 style="margin-bottom: 20px;">Scraping Results</h2>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-products">0</div>
                    <div class="stat-label">Total Products</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-images">0</div>
                    <div class="stat-label">Images Found</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="products-with-price">0</div>
                    <div class="stat-label">With Prices</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="products-with-sku">0</div>
                    <div class="stat-label">With SKUs</div>
                </div>
            </div>

            <div class="download-buttons">
                <button class="download-btn" onclick="downloadCSV()">ðŸ“¥ Download CSV</button>
                <button class="download-btn" onclick="downloadJSON()">ðŸ“¥ Download JSON</button>
                <button class="download-btn" onclick="downloadReport()">ðŸ“„ Download Report</button>
            </div>

            <h3 style="margin-top: 30px; margin-bottom: 15px;">Product Preview</h3>
            <div style="overflow-x: auto;">
                <table class="products-table" id="products-table">
                    <thead>
                        <tr>
                            <th>Image</th>
                            <th>Product Name</th>
                            <th>SKU</th>
                            <th>Price</th>
                            <th>Description</th>
                            <th>Images</th>
                        </tr>
                    </thead>
                    <tbody id="products-tbody">
                        <!-- Products will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let scrapedProducts = [];
        let isScrapingActive = false;

        function addStatusLog(message, type = 'info') {
            const statusLog = document.getElementById('status-log');
            const statusItem = document.createElement('div');
            statusItem.className = `status-item ${type}`;
            const timestamp = new Date().toLocaleTimeString();
            statusItem.textContent = `[${timestamp}] ${message}`;
            statusLog.appendChild(statusItem);
            statusLog.scrollTop = statusLog.scrollHeight;
        }

        function updateProgress(percentage, status) {
            const progressBar = document.getElementById('progress-bar');
            const currentStatus = document.getElementById('current-status');
            
            progressBar.style.width = percentage + '%';
            progressBar.textContent = Math.round(percentage) + '%';
            currentStatus.textContent = status;
        }

        function updateStats(products) {
            document.getElementById('total-products').textContent = products.length;
            
            const totalImages = products.reduce((sum, p) => sum + (p.image_count || 0), 0);
            document.getElementById('total-images').textContent = totalImages;
            
            const withPrice = products.filter(p => p.price && p.price !== 'N/A').length;
            document.getElementById('products-with-price').textContent = withPrice;
            
            const withSKU = products.filter(p => p.sku && p.sku !== 'N/A').length;
            document.getElementById('products-with-sku').textContent = withSKU;
        }

        function displayProducts(products) {
            const tbody = document.getElementById('products-tbody');
            tbody.innerHTML = '';

            products.slice(0, 50).forEach(product => {
                const row = document.createElement('tr');
                
                const imageUrls = product.image_urls ? product.image_urls.split('|') : [];
                const firstImage = imageUrls[0] || '';
                
                row.innerHTML = `
                    <td>
                        ${firstImage ? `<img src="${firstImage}" class="product-image" alt="${product.product_name}">` : 'No image'}
                    </td>
                    <td><strong>${product.product_name || 'N/A'}</strong></td>
                    <td>${product.sku || 'N/A'}</td>
                    <td>${product.price || 'N/A'}</td>
                    <td>${(product.description || 'N/A').substring(0, 100)}...</td>
                    <td>${product.image_count || 0}</td>
                `;
                
                tbody.appendChild(row);
            });

            if (products.length > 50) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="6" style="text-align: center; font-style: italic;">
                    Showing first 50 of ${products.length} products. Download full data using buttons above.
                </td>`;
                tbody.appendChild(row);
            }
        }

        async function startScraping() {
            if (isScrapingActive) {
                alert('Scraping is already in progress!');
                return;
            }

            isScrapingActive = true;
            const startBtn = document.getElementById('start-scrape-btn');
            startBtn.disabled = true;
            startBtn.textContent = 'â³ Scraping in Progress...';

            // Show progress section
            document.getElementById('progress-section').classList.add('active');
            document.getElementById('results-section').classList.remove('active');

            // Clear previous logs
            document.getElementById('status-log').innerHTML = '';

            addStatusLog('Initializing scraper...', 'info');
            updateProgress(5, 'Initializing...');

            // Simulate scraping process (In real implementation, this would call the Python backend)
            await simulateScraping();
        }

        async function simulateScraping() {
            // This is a simulation. In production, you would make API calls to your Python backend
            
            addStatusLog('Starting website crawl...', 'info');
            updateProgress(10, 'Discovering pages...');
            await sleep(2000);

            addStatusLog('Found 45 pages to analyze', 'success');
            updateProgress(25, 'Analyzing pages...');
            await sleep(2000);

            addStatusLog('Extracting product data...', 'info');
            updateProgress(50, 'Extracting products...');
            await sleep(2000);

            // Generate sample data
            const sampleProducts = generateSampleProducts();
            scrapedProducts = sampleProducts;

            addStatusLog(`Found ${sampleProducts.length} products`, 'success');
            updateProgress(75, 'Downloading images...');
            await sleep(2000);

            addStatusLog('Processing complete!', 'success');
            updateProgress(100, 'Complete!');
            
            // Show results
            setTimeout(() => {
                document.getElementById('results-section').classList.add('active');
                updateStats(scrapedProducts);
                displayProducts(scrapedProducts);
                
                const startBtn = document.getElementById('start-scrape-btn');
                startBtn.disabled = false;
                startBtn.textContent = 'ðŸš€ Start Scraping';
                isScrapingActive = false;
            }, 1000);
        }

        function generateSampleProducts() {
            const products = [];
            const productNames = [
                'TapeTech 7" Flat Box',
                'Level5 10" Finishing Trowel',
                'Columbia Corner Roller',
                'TapeTech 3.5" Corner Finisher',
                'Advance Automatic Taper',
                'Level5 Corner Applicator',
                'TapeTech Mud Pump',
                'Columbia Drywall Stilts',
                'Level5 Skimming Blade',
                'TapeTech Compound Tube'
            ];

            for (let i = 0; i < 10; i++) {
                products.push({
                    product_name: productNames[i],
                    sku: `SKU-${1000 + i}`,
                    price: `$${(Math.random() * 200 + 50).toFixed(2)}`,
                    description: `Professional grade ${productNames[i].toLowerCase()} for drywall finishing. High quality construction tools designed for contractors.`,
                    url: `http://alstapingtools.com/product/${i}`,
                    image_urls: `http://example.com/img${i}_1.jpg|http://example.com/img${i}_2.jpg`,
                    image_count: 2,
                    scraped_at: new Date().toISOString()
                });
            }

            return products;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function downloadCSV() {
            if (scrapedProducts.length === 0) {
                alert('No products to download!');
                return;
            }

            const headers = ['Product Name', 'SKU', 'Price', 'Description', 'URL', 'Image URLs', 'Image Count'];
            const csvContent = [
                headers.join(','),
                ...scrapedProducts.map(p => [
                    `"${p.product_name}"`,
                    `"${p.sku}"`,
                    `"${p.price}"`,
                    `"${p.description}"`,
                    `"${p.url}"`,
                    `"${p.image_urls}"`,
                    p.image_count
                ].join(','))
            ].join('\n');

            downloadFile(csvContent, 'alstapingtools_products.csv', 'text/csv');
            addStatusLog('CSV file downloaded', 'success');
        }

        function downloadJSON() {
            if (scrapedProducts.length === 0) {
                alert('No products to download!');
                return;
            }

            const jsonContent = JSON.stringify(scrapedProducts, null, 2);
            downloadFile(jsonContent, 'alstapingtools_products.json', 'application/json');
            addStatusLog('JSON file downloaded', 'success');
        }

        function downloadReport() {
            const report = `
SCRAPING REPORT - AlsTapingTools.com
=====================================

Total Products: ${scrapedProducts.length}
Products with SKU: ${scrapedProducts.filter(p => p.sku !== 'N/A').length}
Products with Price: ${scrapedProducts.filter(p => p.price !== 'N/A').length}
Total Images: ${scrapedProducts.reduce((sum, p) => sum + p.image_count, 0)}

Generated: ${new Date().toLocaleString()}
            `.trim();

            downloadFile(report, 'scraping_report.txt', 'text/plain');
            addStatusLog('Report downloaded', 'success');
        }

        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
